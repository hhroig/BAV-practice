<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Transformaciones | Big Analytics V: Programación en R</title>
  <meta name="description" content="3 Transformaciones | Big Analytics V: Programación en R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Transformaciones | Big Analytics V: Programación en R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Transformaciones | Big Analytics V: Programación en R" />
  
  
  

<meta name="author" content="Harold A. Hernández-Roig" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visualiza.html"/>
<link rel="next" href="tidy.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#referencias"><i class="fa fa-check"></i><b>1.1</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualiza.html"><a href="visualiza.html"><i class="fa fa-check"></i><b>2</b> Visualización</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualiza.html"><a href="visualiza.html#paquetes"><i class="fa fa-check"></i><b>2.1</b> Paquetes</a></li>
<li class="chapter" data-level="2.2" data-path="visualiza.html"><a href="visualiza.html#datos"><i class="fa fa-check"></i><b>2.2</b> Datos</a></li>
<li class="chapter" data-level="2.3" data-path="visualiza.html"><a href="visualiza.html#visualización-con-r-base"><i class="fa fa-check"></i><b>2.3</b> Visualización con R base</a></li>
<li class="chapter" data-level="2.4" data-path="visualiza.html"><a href="visualiza.html#visualización-con-ggplot2"><i class="fa fa-check"></i><b>2.4</b> Visualización con <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="visualiza.html"><a href="visualiza.html#ejercicios"><i class="fa fa-check"></i><b>2.4.1</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4.2" data-path="visualiza.html"><a href="visualiza.html#cambiando-la-estética"><i class="fa fa-check"></i><b>2.4.2</b> Cambiando la <em>estética</em></a></li>
<li class="chapter" data-level="2.4.3" data-path="visualiza.html"><a href="visualiza.html#las-facetas"><i class="fa fa-check"></i><b>2.4.3</b> Las <em>facetas</em></a></li>
<li class="chapter" data-level="2.4.4" data-path="visualiza.html"><a href="visualiza.html#objetos-geométricos-geoms"><i class="fa fa-check"></i><b>2.4.4</b> Objetos geométricos <strong>geoms</strong></a></li>
<li class="chapter" data-level="2.4.5" data-path="visualiza.html"><a href="visualiza.html#transformaciones-estadísticas"><i class="fa fa-check"></i><b>2.4.5</b> Transformaciones estadísticas</a></li>
<li class="chapter" data-level="2.4.6" data-path="visualiza.html"><a href="visualiza.html#ajuste-de-posición-y-sistemas-de-coordenadas"><i class="fa fa-check"></i><b>2.4.6</b> Ajuste de posición y sistemas de coordenadas</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="visualiza.html"><a href="visualiza.html#resumen"><i class="fa fa-check"></i><b>2.5</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="transforma.html"><a href="transforma.html"><i class="fa fa-check"></i><b>3</b> Transformaciones</a>
<ul>
<li class="chapter" data-level="3.1" data-path="transforma.html"><a href="transforma.html#datos-1"><i class="fa fa-check"></i><b>3.1</b> Datos</a></li>
<li class="chapter" data-level="3.2" data-path="transforma.html"><a href="transforma.html#el-paquete-dplyr"><i class="fa fa-check"></i><b>3.2</b> El paquete <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="transforma.html"><a href="transforma.html#filtrar-filas"><i class="fa fa-check"></i><b>3.2.1</b> Filtrar filas</a></li>
<li class="chapter" data-level="3.2.2" data-path="transforma.html"><a href="transforma.html#rerodenar-filas"><i class="fa fa-check"></i><b>3.2.2</b> Rerodenar filas</a></li>
<li class="chapter" data-level="3.2.3" data-path="transforma.html"><a href="transforma.html#seleccionar-variables"><i class="fa fa-check"></i><b>3.2.3</b> Seleccionar variables</a></li>
<li class="chapter" data-level="3.2.4" data-path="transforma.html"><a href="transforma.html#crear-nuevas-variables"><i class="fa fa-check"></i><b>3.2.4</b> Crear nuevas variables</a></li>
<li class="chapter" data-level="3.2.5" data-path="transforma.html"><a href="transforma.html#resumir-variables"><i class="fa fa-check"></i><b>3.2.5</b> Resumir variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>4</b> Tidy</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidy.html"><a href="tidy.html#datos-2"><i class="fa fa-check"></i><b>4.1</b> Datos</a></li>
<li class="chapter" data-level="4.2" data-path="tidy.html"><a href="tidy.html#pivotar"><i class="fa fa-check"></i><b>4.2</b> Pivotar</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="tidy.html"><a href="tidy.html#pivot-longer"><i class="fa fa-check"></i><b>4.2.1</b> <em>Pivot longer</em></a></li>
<li class="chapter" data-level="4.2.2" data-path="tidy.html"><a href="tidy.html#pivot-wider"><i class="fa fa-check"></i><b>4.2.2</b> <em>Pivot wider</em></a></li>
<li class="chapter" data-level="4.2.3" data-path="tidy.html"><a href="tidy.html#ejercicios-13"><i class="fa fa-check"></i><b>4.2.3</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tidy.html"><a href="tidy.html#separar-y-unir"><i class="fa fa-check"></i><b>4.3</b> Separar y unir</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="tidy.html"><a href="tidy.html#ejercicios-14"><i class="fa fa-check"></i><b>4.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="tidy.html"><a href="tidy.html#lidiar-con-los-datos-faltantes"><i class="fa fa-check"></i><b>4.4</b> Lidiar con los datos faltantes</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="tidy.html"><a href="tidy.html#ejercicios-15"><i class="fa fa-check"></i><b>4.4.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="tidy.html"><a href="tidy.html#case-study"><i class="fa fa-check"></i><b>4.5</b> Case study</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="tidy.html"><a href="tidy.html#ejercicios-16"><i class="fa fa-check"></i><b>4.5.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="relational.html"><a href="relational.html"><i class="fa fa-check"></i><b>5</b> Relational Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="relational.html"><a href="relational.html#datos-3"><i class="fa fa-check"></i><b>5.1</b> Datos</a></li>
<li class="chapter" data-level="5.2" data-path="relational.html"><a href="relational.html#keys"><i class="fa fa-check"></i><b>5.2</b> Keys</a></li>
<li class="chapter" data-level="5.3" data-path="relational.html"><a href="relational.html#mutating-joins"><i class="fa fa-check"></i><b>5.3</b> Mutating Joins</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="relational.html"><a href="relational.html#ejercicios-17"><i class="fa fa-check"></i><b>5.3.1</b> Ejercicios:</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="relational.html"><a href="relational.html#filtering-joins"><i class="fa fa-check"></i><b>5.4</b> Filtering Joins</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="relational.html"><a href="relational.html#ejercicios-18"><i class="fa fa-check"></i><b>5.4.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Big Analytics V: Programación en <strong>R</strong></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="transforma" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Transformaciones</h1>
<div id="datos-1" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Datos</h2>
<p>Vamos a trabajar con el <strong>data frame</strong> <a href="https://rdrr.io/cran/nycflights13/man/flights.html"><code>nycflights13::flights</code></a>. Una vez más ten en cuanta los “conflictos” y asegúrate de usar la función correcta (<code>paquete_correcto::fun_repetida(...)</code>).</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="transforma.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb69-2"><a href="transforma.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb69-3"><a href="transforma.html#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="transforma.html#cb69-4" aria-hidden="true" tabindex="-1"></a>flights</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ... with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div id="ejercicios-7" class="section level4" number="3.1.0.1">
<h4><span class="header-section-number">3.1.0.1</span> Ejercicios</h4>
<ol style="list-style-type: decimal">
<li>¿Puedes identificar los tipos de variables?</li>
</ol>
<p><strong>R/</strong></p>
<p>Al imprimir un tibble en la consola, se muestra el tipo de variable debajo de cada columna: <code>&lt;int&gt;</code>, <code>&lt;dbl&gt;</code>, <code>&lt;chr&gt;</code>, etc.</p>
<ol start="2" style="list-style-type: decimal">
<li>¿Qué información puedes extraer de los datos con la función <code>summary()</code>?</li>
</ol>
<p><strong>R/</strong></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="transforma.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(flights)</span></code></pre></div>
<pre><code>##       year          month             day           dep_time    sched_dep_time
##  Min.   :2013   Min.   : 1.000   Min.   : 1.00   Min.   :   1   Min.   : 106  
##  1st Qu.:2013   1st Qu.: 4.000   1st Qu.: 8.00   1st Qu.: 907   1st Qu.: 906  
##  Median :2013   Median : 7.000   Median :16.00   Median :1401   Median :1359  
##  Mean   :2013   Mean   : 6.549   Mean   :15.71   Mean   :1349   Mean   :1344  
##  3rd Qu.:2013   3rd Qu.:10.000   3rd Qu.:23.00   3rd Qu.:1744   3rd Qu.:1729  
##  Max.   :2013   Max.   :12.000   Max.   :31.00   Max.   :2400   Max.   :2359  
##                                                  NA&#39;s   :8255                 
##    dep_delay          arr_time    sched_arr_time   arr_delay       
##  Min.   : -43.00   Min.   :   1   Min.   :   1   Min.   : -86.000  
##  1st Qu.:  -5.00   1st Qu.:1104   1st Qu.:1124   1st Qu.: -17.000  
##  Median :  -2.00   Median :1535   Median :1556   Median :  -5.000  
##  Mean   :  12.64   Mean   :1502   Mean   :1536   Mean   :   6.895  
##  3rd Qu.:  11.00   3rd Qu.:1940   3rd Qu.:1945   3rd Qu.:  14.000  
##  Max.   :1301.00   Max.   :2400   Max.   :2359   Max.   :1272.000  
##  NA&#39;s   :8255      NA&#39;s   :8713                  NA&#39;s   :9430      
##    carrier              flight       tailnum             origin         
##  Length:336776      Min.   :   1   Length:336776      Length:336776     
##  Class :character   1st Qu.: 553   Class :character   Class :character  
##  Mode  :character   Median :1496   Mode  :character   Mode  :character  
##                     Mean   :1972                                        
##                     3rd Qu.:3465                                        
##                     Max.   :8500                                        
##                                                                         
##      dest              air_time        distance         hour      
##  Length:336776      Min.   : 20.0   Min.   :  17   Min.   : 1.00  
##  Class :character   1st Qu.: 82.0   1st Qu.: 502   1st Qu.: 9.00  
##  Mode  :character   Median :129.0   Median : 872   Median :13.00  
##                     Mean   :150.7   Mean   :1040   Mean   :13.18  
##                     3rd Qu.:192.0   3rd Qu.:1389   3rd Qu.:17.00  
##                     Max.   :695.0   Max.   :4983   Max.   :23.00  
##                     NA&#39;s   :9430                                  
##      minute        time_hour                  
##  Min.   : 0.00   Min.   :2013-01-01 05:00:00  
##  1st Qu.: 8.00   1st Qu.:2013-04-04 13:00:00  
##  Median :29.00   Median :2013-07-03 10:00:00  
##  Mean   :26.23   Mean   :2013-07-03 05:22:54  
##  3rd Qu.:44.00   3rd Qu.:2013-10-01 07:00:00  
##  Max.   :59.00   Max.   :2013-12-31 23:00:00  
## </code></pre>
</div>
</div>
<div id="el-paquete-dplyr" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> El paquete <code>dplyr</code></h2>
<p>El objetivo ahora es asimilar las transformaciones de datos que ofrece <code>dplyr</code>:</p>
<ul>
<li>Filtrar observaciones (filas) con <code>filter()</code>,</li>
<li>Reordenar observaciones (filas) con <code>arrange()</code>,</li>
<li>Seleccionar variables (columnas) con <code>select()</code>,</li>
<li>Crear nuevas variables (columnas) aplicando transformaciones (funciones) a las ya existentes con <code>mutate()</code>,</li>
<li>Resumir la información de muchos valores con <code>summarise()</code>,</li>
<li>… puede ser usado con <code>group_by()</code> que agrupa las observaciones de acuerdo a cierta variable categórica.</li>
</ul>
<div id="filtrar-filas" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Filtrar filas</h3>
<p>Con <code>filter()</code> podemos filtrar/extraer las observaciones de acuerdo a características de una o varias variables, usando los operadores de comparación lógicos. Por ejemplo, para filtrar todos los vuelos ocurridos en los 1eros de Enero:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="transforma.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, month <span class="sc">==</span> <span class="dv">1</span>, day <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 842 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ... with 832 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Todos los vuelos de Enero a Febrero:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="transforma.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nivel: &quot;beginner&quot;</span></span>
<span id="cb75-2"><a href="transforma.html#cb75-2" aria-hidden="true" tabindex="-1"></a>flights_1_2 <span class="ot">&lt;-</span> <span class="fu">filter</span>(flights, month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb75-3"><a href="transforma.html#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="transforma.html#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># nivel: &quot;beginner&quot; adelantado</span></span>
<span id="cb75-5"><a href="transforma.html#cb75-5" aria-hidden="true" tabindex="-1"></a>flights_1_2 <span class="ot">&lt;-</span> <span class="fu">filter</span>(flights, month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb75-6"><a href="transforma.html#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="transforma.html#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co"># nivel: &quot;tidyverser&quot; :)</span></span>
<span id="cb75-8"><a href="transforma.html#cb75-8" aria-hidden="true" tabindex="-1"></a>flights_1_2 <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb75-9"><a href="transforma.html#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
<p>Vuelos que no se han retrasado más de 2hrs (tanto salida como llegada):</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="transforma.html#cb76-1" aria-hidden="true" tabindex="-1"></a>not_delayed <span class="ot">&lt;-</span> <span class="fu">filter</span>(flights, arr_delay <span class="sc">&lt;=</span> <span class="dv">120</span>, dep_delay <span class="sc">&lt;=</span> <span class="dv">120</span>)</span></code></pre></div>
<p>Algo interesante de <code>filter()</code> es que deja fuera directamente los <code>NA</code>s.</p>
<div id="ejercicios-8" class="section level4" number="3.2.1.1">
<h4><span class="header-section-number">3.2.1.1</span> Ejercicios:</h4>
<ol start="3" style="list-style-type: decimal">
<li>Encontrar los vuelos (asignar a una nueva variable que nombres apropiadamente):
<ol style="list-style-type: lower-alpha">
<li>Se atrasaron más de 2hrs en llegar</li>
<li>Volaron a Houston (IAH or HOU)</li>
<li>Fueron operados por “United”, “American” o “Deta”</li>
<li>Salieron en el verano (Julio, Agosto y Septiembre)</li>
<li>Llegaron más de 2hrs tarde, pero no salieron tarde</li>
<li>Se retrasaron al menos 1hr, pero compesaron 30min en vuelo</li>
<li>Salieron entre medianoche y 6am (inclusive)</li>
</ol></li>
</ol>
<p><strong>R/</strong></p>
<ol style="list-style-type: lower-alpha">
<li>Se atrasaron más de 2hrs en llegar</li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="transforma.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, arr_delay <span class="sc">&gt;=</span> <span class="dv">120</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10,200 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      811            630       101     1047            830
##  2  2013     1     1      848           1835       853     1001           1950
##  3  2013     1     1      957            733       144     1056            853
##  4  2013     1     1     1114            900       134     1447           1222
##  5  2013     1     1     1505           1310       115     1638           1431
##  6  2013     1     1     1525           1340       105     1831           1626
##  7  2013     1     1     1549           1445        64     1912           1656
##  8  2013     1     1     1558           1359       119     1718           1515
##  9  2013     1     1     1732           1630        62     2028           1825
## 10  2013     1     1     1803           1620       103     2008           1750
## # ... with 10,190 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Volaron a Houston (IAH or HOU)</li>
</ol>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="transforma.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, dest <span class="sc">==</span> <span class="st">&quot;IAH&quot;</span> <span class="sc">|</span> dest <span class="sc">==</span> <span class="st">&quot;HOU&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 9,313 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      623            627        -4      933            932
##  4  2013     1     1      728            732        -4     1041           1038
##  5  2013     1     1      739            739         0     1104           1038
##  6  2013     1     1      908            908         0     1228           1219
##  7  2013     1     1     1028           1026         2     1350           1339
##  8  2013     1     1     1044           1045        -1     1352           1351
##  9  2013     1     1     1114            900       134     1447           1222
## 10  2013     1     1     1205           1200         5     1503           1505
## # ... with 9,303 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Fueron operados por “United”, “American” o “Deta”</li>
</ol>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="transforma.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, carrier <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;DL&quot;</span>, <span class="st">&quot;UA&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 139,504 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      554            600        -6      812            837
##  5  2013     1     1      554            558        -4      740            728
##  6  2013     1     1      558            600        -2      753            745
##  7  2013     1     1      558            600        -2      924            917
##  8  2013     1     1      558            600        -2      923            937
##  9  2013     1     1      559            600        -1      941            910
## 10  2013     1     1      559            600        -1      854            902
## # ... with 139,494 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>Salieron en el verano (Julio, Agosto y Septiembre)</li>
</ol>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="transforma.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, month <span class="sc">&gt;=</span> <span class="dv">7</span>, month <span class="sc">&lt;=</span> <span class="dv">9</span>)</span></code></pre></div>
<pre><code>## # A tibble: 86,326 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     7     1        1           2029       212      236           2359
##  2  2013     7     1        2           2359         3      344            344
##  3  2013     7     1       29           2245       104      151              1
##  4  2013     7     1       43           2130       193      322             14
##  5  2013     7     1       44           2150       174      300            100
##  6  2013     7     1       46           2051       235      304           2358
##  7  2013     7     1       48           2001       287      308           2305
##  8  2013     7     1       58           2155       183      335             43
##  9  2013     7     1      100           2146       194      327             30
## 10  2013     7     1      100           2245       135      337            135
## # ... with 86,316 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li>Llegaron más de 2hrs tarde, pero no salieron tarde</li>
</ol>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="transforma.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, arr_delay <span class="sc">&gt;</span> <span class="dv">120</span>, dep_delay <span class="sc">&lt;=</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## # A tibble: 29 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1    27     1419           1420        -1     1754           1550
##  2  2013    10     7     1350           1350         0     1736           1526
##  3  2013    10     7     1357           1359        -2     1858           1654
##  4  2013    10    16      657            700        -3     1258           1056
##  5  2013    11     1      658            700        -2     1329           1015
##  6  2013     3    18     1844           1847        -3       39           2219
##  7  2013     4    17     1635           1640        -5     2049           1845
##  8  2013     4    18      558            600        -2     1149            850
##  9  2013     4    18      655            700        -5     1213            950
## 10  2013     5    22     1827           1830        -3     2217           2010
## # ... with 19 more rows, and 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,
## #   flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,
## #   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="6" style="list-style-type: lower-alpha">
<li>Se retrasaron al menos 1hr, pero compesaron 30min en vuelo</li>
</ol>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="transforma.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, dep_delay <span class="sc">&gt;=</span> <span class="dv">60</span>, dep_delay <span class="sc">-</span> arr_delay <span class="sc">&gt;</span> <span class="dv">30</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,844 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1     2205           1720       285       46           2040
##  2  2013     1     1     2326           2130       116      131             18
##  3  2013     1     3     1503           1221       162     1803           1555
##  4  2013     1     3     1839           1700        99     2056           1950
##  5  2013     1     3     1850           1745        65     2148           2120
##  6  2013     1     3     1941           1759       102     2246           2139
##  7  2013     1     3     1950           1845        65     2228           2227
##  8  2013     1     3     2015           1915        60     2135           2111
##  9  2013     1     3     2257           2000       177       45           2224
## 10  2013     1     4     1917           1700       137     2135           1950
## # ... with 1,834 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="7" style="list-style-type: lower-alpha">
<li>Salieron entre medianoche y 6am (inclusive). No</li>
</ol>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="transforma.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 1:</span></span>
<span id="cb89-2"><a href="transforma.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, dep_time <span class="sc">&lt;=</span> <span class="dv">600</span> <span class="sc">|</span> dep_time <span class="sc">==</span> <span class="dv">2400</span>)</span></code></pre></div>
<pre><code>## # A tibble: 9,373 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ... with 9,363 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="transforma.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 2:</span></span>
<span id="cb91-2"><a href="transforma.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, dep_time <span class="sc">%%</span> <span class="dv">2400</span> <span class="sc">&lt;=</span> <span class="dv">600</span>)</span></code></pre></div>
<pre><code>## # A tibble: 9,373 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ... with 9,363 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Busca la ayuda de <code>between()</code> e intenta simplificar un poco tus respuestas al ejercicio anterior.</li>
</ol>
<p><strong>R/</strong></p>
<p>La expresión <code>between(x, left, right)</code> es equivalente a <code>x &gt;= left &amp; x &lt;= right</code>. En el ejercicio “d. Salieron en el verano (Julio, Agosto y Septiembre)”, podemos hacer:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="transforma.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, <span class="fu">between</span>(month, <span class="dv">7</span>, <span class="dv">9</span>))</span></code></pre></div>
<pre><code>## # A tibble: 86,326 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     7     1        1           2029       212      236           2359
##  2  2013     7     1        2           2359         3      344            344
##  3  2013     7     1       29           2245       104      151              1
##  4  2013     7     1       43           2130       193      322             14
##  5  2013     7     1       44           2150       174      300            100
##  6  2013     7     1       46           2051       235      304           2358
##  7  2013     7     1       48           2001       287      308           2305
##  8  2013     7     1       58           2155       183      335             43
##  9  2013     7     1      100           2146       194      327             30
## 10  2013     7     1      100           2245       135      337            135
## # ... with 86,316 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>¿Cuántos vuelos no tienen información sobre <code>dep_time</code>? ¿Alguna otra variable tiene datos perdidos? ¿Qué crees que representan en cada caso?</li>
</ol>
<p><strong>R/</strong></p>
<p>Parecen ser vuelos cancelados, también <code>arr_time</code> presenta <code>NA</code>s en estos casos:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="transforma.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, <span class="fu">is.na</span>(dep_time))</span></code></pre></div>
<pre><code>## # A tibble: 8,255 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1       NA           1630        NA       NA           1815
##  2  2013     1     1       NA           1935        NA       NA           2240
##  3  2013     1     1       NA           1500        NA       NA           1825
##  4  2013     1     1       NA            600        NA       NA            901
##  5  2013     1     2       NA           1540        NA       NA           1747
##  6  2013     1     2       NA           1620        NA       NA           1746
##  7  2013     1     2       NA           1355        NA       NA           1459
##  8  2013     1     2       NA           1420        NA       NA           1644
##  9  2013     1     2       NA           1321        NA       NA           1536
## 10  2013     1     2       NA           1545        NA       NA           1910
## # ... with 8,245 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>¿Qué crees de los siguientes resultados?</li>
</ol>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="transforma.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span><span class="sc">^</span><span class="dv">0</span> <span class="co"># R/ todo x^0 = 1</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="transforma.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">|</span> <span class="cn">TRUE</span> <span class="co"># R/</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="transforma.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="cn">FALSE</span> <span class="sc">&amp;</span> <span class="cn">NA</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="transforma.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">*</span> <span class="dv">0</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p><strong>R/</strong>
* <code>NA^0</code> es <code>0</code> porque <span class="math inline">\(x^0 = 1\)</span> para todo <span class="math inline">\(x\)</span>.
* <code>NA | TRUE</code> es <code>NA | TRUE</code> porque si el valor faltante fuera <code>TRUE</code>: entonces <code>TRUE | TRUE == TRUE</code>. Si el faltante es <code>FALSE</code>, entonces <code>FALSE | TRUE == TRUE</code>.
* <code>FALSE &amp; NA</code> es <code>FALSE</code>. Si el <code>NA</code> es <code>TRUE</code>: <code>TRUE &amp; FALSE == FALSE</code>. Si el <code>NA</code> fuera <code>FALSE</code>: <code>FALSE &amp; FALSE == FALSE</code>.
* <code>NA * 0</code> es <code>0</code>, porque tiene en cuenta las indeterminaciones <span class="math inline">\(\pm \infty \times 0\)</span>, en cuyo caso el resultdo sería <code>NaN</code>. Para cualquier <span class="math inline">\(x\neq \pm \infty\)</span> tendríamos <code>x * 0 == 0</code>.</p>
</div>
</div>
<div id="rerodenar-filas" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Rerodenar filas</h3>
<p>Con <code>arrange()</code> podemos ordenar las observaciones (filas) de nuestros data frame, de acuerdo a una o más variables (columnas). En general, la ordenación se hará de acuerdo a la primera variable y el resto se usará en caso de “empate”. Por defecto, la ordenación es ascendente y los <code>NA</code> se colocan al final:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="transforma.html#cb105-1" aria-hidden="true" tabindex="-1"></a>fl_asc <span class="ot">&lt;-</span>  <span class="fu">arrange</span>(flights, year, month, day, dep_time)</span>
<span id="cb105-2"><a href="transforma.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fl_asc, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## # A tibble: 7 x 19
##    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
## 1  2013     1     1      517            515         2      830            819
## 2  2013     1     1      533            529         4      850            830
## 3  2013     1     1      542            540         2      923            850
## 4  2013     1     1      544            545        -1     1004           1022
## 5  2013     1     1      554            600        -6      812            837
## 6  2013     1     1      554            558        -4      740            728
## 7  2013     1     1      555            600        -5      913            854
## # ... with 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="transforma.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(fl_asc, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## # A tibble: 7 x 19
##    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
## 1  2013    12    31       NA           1430        NA       NA           1750
## 2  2013    12    31       NA            855        NA       NA           1142
## 3  2013    12    31       NA            705        NA       NA            931
## 4  2013    12    31       NA            825        NA       NA           1029
## 5  2013    12    31       NA           1615        NA       NA           1800
## 6  2013    12    31       NA            600        NA       NA            735
## 7  2013    12    31       NA            830        NA       NA           1154
## # ... with 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Orden descendente, de acuerdo a <code>dep_time</code>:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="transforma.html#cb109-1" aria-hidden="true" tabindex="-1"></a>fl_dsc <span class="ot">&lt;-</span>  <span class="fu">arrange</span>(flights, <span class="fu">desc</span>(dep_time))</span>
<span id="cb109-2"><a href="transforma.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fl_dsc, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## # A tibble: 7 x 19
##    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
## 1  2013    10    30     2400           2359         1      327            337
## 2  2013    11    27     2400           2359         1      515            445
## 3  2013    12     5     2400           2359         1      427            440
## 4  2013    12     9     2400           2359         1      432            440
## 5  2013    12     9     2400           2250        70       59           2356
## 6  2013    12    13     2400           2359         1      432            440
## 7  2013    12    19     2400           2359         1      434            440
## # ... with 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div id="ejercicios-9" class="section level4" number="3.2.2.1">
<h4><span class="header-section-number">3.2.2.1</span> Ejercicios</h4>
<ol start="7" style="list-style-type: decimal">
<li>Si por defecto <code>arrange()</code> coloca los <code>NA</code> al final, ¿hay alguna forma de colocarlos al inicio? Hint: usa <code>is.na()</code>.</li>
</ol>
<p><strong>R/</strong></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="transforma.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, <span class="fu">desc</span>(<span class="fu">is.na</span>(dep_time)), dep_time)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1       NA           1630        NA       NA           1815
##  2  2013     1     1       NA           1935        NA       NA           2240
##  3  2013     1     1       NA           1500        NA       NA           1825
##  4  2013     1     1       NA            600        NA       NA            901
##  5  2013     1     2       NA           1540        NA       NA           1747
##  6  2013     1     2       NA           1620        NA       NA           1746
##  7  2013     1     2       NA           1355        NA       NA           1459
##  8  2013     1     2       NA           1420        NA       NA           1644
##  9  2013     1     2       NA           1321        NA       NA           1536
## 10  2013     1     2       NA           1545        NA       NA           1910
## # ... with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Ordena los vuelos para encontrar los que más se retrasaron.</li>
</ol>
<p><strong>R/</strong></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="transforma.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, <span class="fu">desc</span>(dep_delay))</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     9      641            900      1301     1242           1530
##  2  2013     6    15     1432           1935      1137     1607           2120
##  3  2013     1    10     1121           1635      1126     1239           1810
##  4  2013     9    20     1139           1845      1014     1457           2210
##  5  2013     7    22      845           1600      1005     1044           1815
##  6  2013     4    10     1100           1900       960     1342           2211
##  7  2013     3    17     2321            810       911      135           1020
##  8  2013     6    27      959           1900       899     1236           2226
##  9  2013     7    22     2257            759       898      121           1026
## 10  2013    12     5      756           1700       896     1058           2020
## # ... with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="9" style="list-style-type: decimal">
<li>Encuentra los que despegaron antes.</li>
</ol>
<p><strong>R/</strong></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="transforma.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, dep_delay)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013    12     7     2040           2123       -43       40           2352
##  2  2013     2     3     2022           2055       -33     2240           2338
##  3  2013    11    10     1408           1440       -32     1549           1559
##  4  2013     1    11     1900           1930       -30     2233           2243
##  5  2013     1    29     1703           1730       -27     1947           1957
##  6  2013     8     9      729            755       -26     1002            955
##  7  2013    10    23     1907           1932       -25     2143           2143
##  8  2013     3    30     2030           2055       -25     2213           2250
##  9  2013     3     2     1431           1455       -24     1601           1631
## 10  2013     5     5      934            958       -24     1225           1309
## # ... with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="10" style="list-style-type: decimal">
<li>Ordena los vuelos de forma tal que permita encuentra los de mayor velocidad.</li>
</ol>
<p><strong>R/</strong></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="transforma.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Si lo entendemos por tiempo de vuelo:</span></span>
<span id="cb117-2"><a href="transforma.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">arrange</span>(flights, air_time))</span></code></pre></div>
<pre><code>## # A tibble: 6 x 19
##    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
## 1  2013     1    16     1355           1315        40     1442           1411
## 2  2013     4    13      537            527        10      622            628
## 3  2013    12     6      922            851        31     1021            954
## 4  2013     2     3     2153           2129        24     2247           2224
## 5  2013     2     5     1303           1315       -12     1342           1411
## 6  2013     2    12     2123           2130        -7     2211           2225
## # ... with 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="transforma.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Si lo entendemos por velocidad media:</span></span>
<span id="cb119-2"><a href="transforma.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">arrange</span>(flights, <span class="fu">desc</span>(distance <span class="sc">/</span> air_time)))</span></code></pre></div>
<pre><code>## # A tibble: 6 x 19
##    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
## 1  2013     5    25     1709           1700         9     1923           1937
## 2  2013     7     2     1558           1513        45     1745           1719
## 3  2013     5    13     2040           2025        15     2225           2226
## 4  2013     3    23     1914           1910         4     2045           2043
## 5  2013     1    12     1559           1600        -1     1849           1917
## 6  2013    11    17      650            655        -5     1059           1150
## # ... with 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ol start="11" style="list-style-type: decimal">
<li>¿Cuáles son los vuelos que mayor (menor) distancia recorrieron?</li>
</ol>
<p><strong>R/</strong></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="transforma.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mayor distancia:</span></span>
<span id="cb121-2"><a href="transforma.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, <span class="fu">desc</span>(distance))</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      857            900        -3     1516           1530
##  2  2013     1     2      909            900         9     1525           1530
##  3  2013     1     3      914            900        14     1504           1530
##  4  2013     1     4      900            900         0     1516           1530
##  5  2013     1     5      858            900        -2     1519           1530
##  6  2013     1     6     1019            900        79     1558           1530
##  7  2013     1     7     1042            900       102     1620           1530
##  8  2013     1     8      901            900         1     1504           1530
##  9  2013     1     9      641            900      1301     1242           1530
## 10  2013     1    10      859            900        -1     1449           1530
## # ... with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="transforma.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Menor distancia:</span></span>
<span id="cb123-2"><a href="transforma.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, distance)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     7    27       NA            106        NA       NA            245
##  2  2013     1     3     2127           2129        -2     2222           2224
##  3  2013     1     4     1240           1200        40     1333           1306
##  4  2013     1     4     1829           1615       134     1937           1721
##  5  2013     1     4     2128           2129        -1     2218           2224
##  6  2013     1     5     1155           1200        -5     1241           1306
##  7  2013     1     6     2125           2129        -4     2224           2224
##  8  2013     1     7     2124           2129        -5     2212           2224
##  9  2013     1     8     2127           2130        -3     2304           2225
## 10  2013     1     9     2126           2129        -3     2217           2224
## # ... with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<div id="seleccionar-variables" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Seleccionar variables</h3>
<p>Con <code>select()</code> podemos justamente seleccionar variables (columnas) de interés.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="transforma.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionamos año, mes y día</span></span>
<span id="cb125-2"><a href="transforma.html#cb125-2" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb125-3"><a href="transforma.html#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb125-4"><a href="transforma.html#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##    year month   day
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1  2013     1     1
## 2  2013     1     1
## 3  2013     1     1
## 4  2013     1     1
## 5  2013     1     1</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="transforma.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionamos todas las columnas desde año (year) hasta día (day),</span></span>
<span id="cb127-2"><a href="transforma.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ambas inclusive</span></span>
<span id="cb127-3"><a href="transforma.html#cb127-3" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb127-4"><a href="transforma.html#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year<span class="sc">:</span>day) <span class="sc">%&gt;%</span> </span>
<span id="cb127-5"><a href="transforma.html#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##    year month   day
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1  2013     1     1
## 2  2013     1     1
## 3  2013     1     1
## 4  2013     1     1
## 5  2013     1     1</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="transforma.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionamos todas las columnas excepto las que van desde año (year) </span></span>
<span id="cb129-2"><a href="transforma.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co"># hasta día (day), ambas inclusive</span></span>
<span id="cb129-3"><a href="transforma.html#cb129-3" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb129-4"><a href="transforma.html#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>(year<span class="sc">:</span>day)) <span class="sc">%&gt;%</span> </span>
<span id="cb129-5"><a href="transforma.html#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 16
##   dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier
##      &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;  
## 1      517            515         2      830            819        11 UA     
## 2      533            529         4      850            830        20 UA     
## 3      542            540         2      923            850        33 AA     
## 4      544            545        -1     1004           1022       -18 B6     
## 5      554            600        -6      812            837       -25 DL     
## # ... with 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
## #   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
## #   time_hour &lt;dttm&gt;</code></pre>
<p>También dispondremos de las “funciones de ayuda a la selección”:</p>
<ul>
<li><code>starts_with("abc")</code>: columnas que empiezan en “abc”.</li>
<li><code>ends_with("xyz")</code>: columnas que terminan en “xyz”.</li>
<li><code>contains("ijk")</code>: columnas que contienen la expresión “ijk”.</li>
<li><code>matches(""[pt]xyz"")</code>: selecciona variables que coinciden con una expresión regular.</li>
<li><code>num_range("x", 1:3)</code>: equivalente a seleccionr: <code>paste0("x", 1:3)</code>.</li>
<li><code>everuthing()</code>: selecciona todas las variables. Útil si deseamos poner algunas columnas de interés al incio, porque <code>select()</code> no incluye columnas repetidas:</li>
</ul>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="transforma.html#cb131-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="transforma.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time_hour, air_time, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb131-3"><a href="transforma.html#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 19
##   time_hour           air_time  year month   day dep_time sched_dep_time
##   &lt;dttm&gt;                 &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;
## 1 2013-01-01 05:00:00      227  2013     1     1      517            515
## 2 2013-01-01 05:00:00      227  2013     1     1      533            529
## 3 2013-01-01 05:00:00      160  2013     1     1      542            540
## 4 2013-01-01 05:00:00      183  2013     1     1      544            545
## 5 2013-01-01 06:00:00      116  2013     1     1      554            600
## # ... with 12 more variables: dep_delay &lt;dbl&gt;, arr_time &lt;int&gt;,
## #   sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
## #   minute &lt;dbl&gt;</code></pre>
<div id="ejercicios-10" class="section level4" number="3.2.3.1">
<h4><span class="header-section-number">3.2.3.1</span> Ejercicios</h4>
<ol start="12" style="list-style-type: decimal">
<li>¿Cuál será la forma más corta de seleccionar: <code>dep_time</code>, <code>dep_delay</code>, <code>arr_time</code>, <code>arr_delay</code>?</li>
</ol>
<p><strong>R/</strong></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="transforma.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción elegante:</span></span>
<span id="cb133-2"><a href="transforma.html#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="fu">starts_with</span>(<span class="st">&quot;dep_&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;arr_&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 4
##    dep_time dep_delay arr_time arr_delay
##       &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
##  1      517         2      830        11
##  2      533         4      850        20
##  3      542         2      923        33
##  4      544        -1     1004       -18
##  5      554        -6      812       -25
##  6      554        -4      740        12
##  7      555        -5      913        19
##  8      557        -3      709       -14
##  9      557        -3      838        -8
## 10      558        -2      753         8
## # ... with 336,766 more rows</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="transforma.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Menos elegante, pero funcional y corta:</span></span>
<span id="cb135-2"><a href="transforma.html#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">9</span>)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 4
##    dep_time dep_delay arr_time arr_delay
##       &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
##  1      517         2      830        11
##  2      533         4      850        20
##  3      542         2      923        33
##  4      544        -1     1004       -18
##  5      554        -6      812       -25
##  6      554        -4      740        12
##  7      555        -5      913        19
##  8      557        -3      709       -14
##  9      557        -3      838        -8
## 10      558        -2      753         8
## # ... with 336,766 more rows</code></pre>
<ol start="13" style="list-style-type: decimal">
<li>Queremos seleccionar las variables indicadas en el vector <code>vars</code>. Hint: usar <code>any_of</code>.</li>
</ol>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="transforma.html#cb137-1" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;day&quot;</span>, <span class="st">&quot;dep_delay&quot;</span>, <span class="st">&quot;arr_delay&quot;</span>)</span></code></pre></div>
<p><strong>R/</strong></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="transforma.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="fu">any_of</span>(vars))</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 5
##     year month   day dep_delay arr_delay
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1  2013     1     1         2        11
##  2  2013     1     1         4        20
##  3  2013     1     1         2        33
##  4  2013     1     1        -1       -18
##  5  2013     1     1        -6       -25
##  6  2013     1     1        -4        12
##  7  2013     1     1        -5        19
##  8  2013     1     1        -3       -14
##  9  2013     1     1        -3        -8
## 10  2013     1     1        -2         8
## # ... with 336,766 more rows</code></pre>
<ol start="14" style="list-style-type: decimal">
<li>¿Qué pasa con el siguiente código? ¿Debería seleccionar todas esas variables?</li>
</ol>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="transforma.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="fu">contains</span>(<span class="st">&quot;TiMe&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 6
##    dep_time sched_dep_time arr_time sched_arr_time air_time time_hour          
##       &lt;int&gt;          &lt;int&gt;    &lt;int&gt;          &lt;int&gt;    &lt;dbl&gt; &lt;dttm&gt;             
##  1      517            515      830            819      227 2013-01-01 05:00:00
##  2      533            529      850            830      227 2013-01-01 05:00:00
##  3      542            540      923            850      160 2013-01-01 05:00:00
##  4      544            545     1004           1022      183 2013-01-01 05:00:00
##  5      554            600      812            837      116 2013-01-01 06:00:00
##  6      554            558      740            728      150 2013-01-01 05:00:00
##  7      555            600      913            854      158 2013-01-01 06:00:00
##  8      557            600      709            723       53 2013-01-01 06:00:00
##  9      557            600      838            846      140 2013-01-01 06:00:00
## 10      558            600      753            745      138 2013-01-01 06:00:00
## # ... with 336,766 more rows</code></pre>
<p><strong>R/</strong></p>
<p>Para cambiar el resultado, podemos hacer que coincidan también las letras en mayúscula y minúsucula:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="transforma.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="fu">contains</span>(<span class="st">&quot;TiMe&quot;</span>, <span class="at">ignore.case =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 0</code></pre>
</div>
</div>
<div id="crear-nuevas-variables" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Crear nuevas variables</h3>
<p>Con <code>mutate()</code> podemos añadir nuevas columnas a nuestro data frame. Estas columnas se crean al aplicar las funciones que conocemos (operaciones aritméticas, <em>lags</em>, acumulados, etc.) a las columnas ya existentes.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="transforma.html#cb144-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb144-2"><a href="transforma.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gain =</span> dep_delay <span class="sc">-</span> arr_delay,</span>
<span id="cb144-3"><a href="transforma.html#cb144-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">speed =</span> distance <span class="sc">/</span> air_time <span class="sc">*</span> <span class="dv">60</span>,</span>
<span id="cb144-4"><a href="transforma.html#cb144-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">hours =</span> air_time <span class="sc">/</span> <span class="dv">60</span>,</span>
<span id="cb144-5"><a href="transforma.html#cb144-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">gain_per_hour =</span> gain <span class="sc">/</span> hours) <span class="sc">%&gt;%</span>  <span class="co"># ¡usamos las columnas nuevas!</span></span>
<span id="cb144-6"><a href="transforma.html#cb144-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gain, speed, hours, gain_per_hour, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb144-7"><a href="transforma.html#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 23
##    gain speed hours gain_per_hour  year month   day dep_time sched_dep_time
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;
## 1    -9  370.  3.78         -2.38  2013     1     1      517            515
## 2   -16  374.  3.78         -4.23  2013     1     1      533            529
## 3   -31  408.  2.67        -11.6   2013     1     1      542            540
## 4    17  517.  3.05          5.57  2013     1     1      544            545
## 5    19  394.  1.93          9.83  2013     1     1      554            600
## # ... with 14 more variables: dep_delay &lt;dbl&gt;, arr_time &lt;int&gt;,
## #   sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Si solamente nos interesan las nuevas columnas que hemos creado, usamos <code>transmute()</code>:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="transforma.html#cb146-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb146-2"><a href="transforma.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">gain =</span> dep_delay <span class="sc">-</span> arr_delay,</span>
<span id="cb146-3"><a href="transforma.html#cb146-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">speed =</span> distance <span class="sc">/</span> air_time <span class="sc">*</span> <span class="dv">60</span>,</span>
<span id="cb146-4"><a href="transforma.html#cb146-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">hours =</span> air_time <span class="sc">/</span> <span class="dv">60</span>,</span>
<span id="cb146-5"><a href="transforma.html#cb146-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">gain_per_hour =</span> gain <span class="sc">/</span> hours) <span class="sc">%&gt;%</span>  <span class="co"># ¡usamos las columnas nuevas!</span></span>
<span id="cb146-6"><a href="transforma.html#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##    gain speed hours gain_per_hour
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
## 1    -9  370.  3.78         -2.38
## 2   -16  374.  3.78         -4.23
## 3   -31  408.  2.67        -11.6 
## 4    17  517.  3.05          5.57
## 5    19  394.  1.93          9.83</code></pre>
<div id="ejercicios-11" class="section level4" number="3.2.4.1">
<h4><span class="header-section-number">3.2.4.1</span> Ejercicios</h4>
<ol start="15" style="list-style-type: decimal">
<li>Convertir <code>dep_time</code> y <code>sched_dep_time</code> a minutos transcurridos desde la medianoche. Notar que son variables importantes pero con un formato difícil de trabajar (es complicado hacer operaciones artiméticas con ellos). Sigue las siguientes directrices:</li>
</ol>
<ul>
<li>Una observación de <code>dep_time</code> sería por ejemplo <code>2021</code> que indica las 20:21hrs (8:21pm).</li>
<li>Para obtener las horas transcurridas dede la medianoche hasta las 20:21hrs tendremos que usar la división entera <code>2021 %/% 100 == 20</code>. Luego es fácil obtener los minutos multiplicando por 60.</li>
<li>Los 21 minutos restantes podemos obtenerlos con el resto de la división <code>2021 %% 100 == 21</code>… no olvides sumar ambas cantidades</li>
<li>Finalmente, tendrás que lidiar con la medianoche, representada con <code>2400</code>. Primero, comprueba a cuántos minutos corresponde según nuestras operaciones. Luego, considera calcular el resto de la división por esta cantidad de minutos (siempre que <code>x &lt;= y</code> y ambos sean positivos, tendremos <code>x %% y == 0</code>).</li>
</ul>
<p><strong>R/</strong></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="transforma.html#cb148-1" aria-hidden="true" tabindex="-1"></a>flights_times <span class="ot">&lt;-</span> <span class="fu">mutate</span>(flights,</span>
<span id="cb148-2"><a href="transforma.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep_time_mins =</span> (dep_time <span class="sc">%/%</span> <span class="dv">100</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">+</span> dep_time <span class="sc">%%</span> <span class="dv">100</span>) <span class="sc">%%</span> <span class="dv">1440</span>,</span>
<span id="cb148-3"><a href="transforma.html#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sched_dep_time_mins =</span> (sched_dep_time <span class="sc">%/%</span> <span class="dv">100</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">+</span></span>
<span id="cb148-4"><a href="transforma.html#cb148-4" aria-hidden="true" tabindex="-1"></a>    sched_dep_time <span class="sc">%%</span> <span class="dv">100</span>) <span class="sc">%%</span> <span class="dv">1440</span></span>
<span id="cb148-5"><a href="transforma.html#cb148-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-6"><a href="transforma.html#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(</span>
<span id="cb148-7"><a href="transforma.html#cb148-7" aria-hidden="true" tabindex="-1"></a>  flights_times, dep_time, dep_time_mins, sched_dep_time,</span>
<span id="cb148-8"><a href="transforma.html#cb148-8" aria-hidden="true" tabindex="-1"></a>  sched_dep_time_mins</span>
<span id="cb148-9"><a href="transforma.html#cb148-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 4
##    dep_time dep_time_mins sched_dep_time sched_dep_time_mins
##       &lt;int&gt;         &lt;dbl&gt;          &lt;int&gt;               &lt;dbl&gt;
##  1      517           317            515                 315
##  2      533           333            529                 329
##  3      542           342            540                 340
##  4      544           344            545                 345
##  5      554           354            600                 360
##  6      554           354            558                 358
##  7      555           355            600                 360
##  8      557           357            600                 360
##  9      557           357            600                 360
## 10      558           358            600                 360
## # ... with 336,766 more rows</code></pre>
<ol start="16" style="list-style-type: decimal">
<li>Compara <code>air_time</code> con <code>arr_time - dep_time</code>. ¿Es necesaria hacer la transformación del ejercicio anterior? ¿Puedes encontrar en cuántos casos <code>air_time != arr_time - dep_time</code>? ¿Por qué pasa esto, no deberíamos obtener que el tiempo de vuelo es la diferencia entre la llegada y la salida?</li>
</ol>
<p><strong>R/</strong></p>
<p>Calculamos primero tiempo de vuelo:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="transforma.html#cb150-1" aria-hidden="true" tabindex="-1"></a>flights_airtime <span class="ot">&lt;-</span></span>
<span id="cb150-2"><a href="transforma.html#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(flights,</span>
<span id="cb150-3"><a href="transforma.html#cb150-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_time =</span> (dep_time <span class="sc">%/%</span> <span class="dv">100</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">+</span> dep_time <span class="sc">%%</span> <span class="dv">100</span>) <span class="sc">%%</span> <span class="dv">1440</span>,</span>
<span id="cb150-4"><a href="transforma.html#cb150-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">arr_time =</span> (arr_time <span class="sc">%/%</span> <span class="dv">100</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">+</span> arr_time <span class="sc">%%</span> <span class="dv">100</span>) <span class="sc">%%</span> <span class="dv">1440</span>,</span>
<span id="cb150-5"><a href="transforma.html#cb150-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">air_time_diff =</span> air_time <span class="sc">-</span> arr_time <span class="sc">+</span> dep_time</span>
<span id="cb150-6"><a href="transforma.html#cb150-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Pero notamos que <code>air_time != arr_time - dep_time</code> lo cual no es intuitivo:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="transforma.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(<span class="fu">filter</span>(flights_airtime, air_time_diff <span class="sc">!=</span> <span class="dv">0</span>))</span></code></pre></div>
<pre><code>## [1] 327150</code></pre>
<p>La relación que sí se cumple es <code>air_time &lt;= arr_time - dep_time</code>. El problema es que <code>air_time</code> solo cuenta el tiempo desde que desepega hasta que aterriza, sin contar el desplazamiento hasta la pista o el tiempo en alcanzar la velocidad apropiada antes de despegar.</p>
<ol start="17" style="list-style-type: decimal">
<li>¿Qué relación crees que habrá entre <code>dep_time</code>, <code>sched_dep_time</code> y <code>dep_delay</code>? Encuentra el número de observaciones en las que no se cumple tu hipótesis.</li>
</ol>
<p><strong>R/</strong></p>
<p>Esperaríamos que <code>dep_time - sched_dep_time == dep_delay</code>, pero esto no siempre es así:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="transforma.html#cb153-1" aria-hidden="true" tabindex="-1"></a>flights_deptime <span class="ot">&lt;-</span></span>
<span id="cb153-2"><a href="transforma.html#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(flights,</span>
<span id="cb153-3"><a href="transforma.html#cb153-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_time_min =</span> (dep_time <span class="sc">%/%</span> <span class="dv">100</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">+</span> dep_time <span class="sc">%%</span> <span class="dv">100</span>) <span class="sc">%%</span> <span class="dv">1440</span>,</span>
<span id="cb153-4"><a href="transforma.html#cb153-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sched_dep_time_min =</span> (sched_dep_time <span class="sc">%/%</span> <span class="dv">100</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">+</span></span>
<span id="cb153-5"><a href="transforma.html#cb153-5" aria-hidden="true" tabindex="-1"></a>      sched_dep_time <span class="sc">%%</span> <span class="dv">100</span>) <span class="sc">%%</span> <span class="dv">1440</span>,</span>
<span id="cb153-6"><a href="transforma.html#cb153-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_delay_diff =</span> dep_delay <span class="sc">-</span> dep_time_min <span class="sc">+</span> sched_dep_time_min</span>
<span id="cb153-7"><a href="transforma.html#cb153-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb153-8"><a href="transforma.html#cb153-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-9"><a href="transforma.html#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights_deptime, dep_delay_diff <span class="sc">!=</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,236 x 22
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      848           1835       853     1001           1950
##  2  2013     1     2       42           2359        43      518            442
##  3  2013     1     2      126           2250       156      233           2359
##  4  2013     1     3       32           2359        33      504            442
##  5  2013     1     3       50           2145       185      203           2311
##  6  2013     1     3      235           2359       156      700            437
##  7  2013     1     4       25           2359        26      505            442
##  8  2013     1     4      106           2245       141      201           2356
##  9  2013     1     5       14           2359        15      503            445
## 10  2013     1     5       37           2230       127      341            131
## # ... with 1,226 more rows, and 14 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;,
## #   dep_time_min &lt;dbl&gt;, sched_dep_time_min &lt;dbl&gt;, dep_delay_diff &lt;dbl&gt;</code></pre>
<p>En este caso, las discrepancias podrían estar debidas a algún error al recoger los datos.</p>
<ol start="18" style="list-style-type: decimal">
<li>Encuentra los 10 vuelos que más se retrasaron.</li>
</ol>
<p><strong>R/</strong></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="transforma.html#cb155-1" aria-hidden="true" tabindex="-1"></a>flights_delayed10 <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span>  </span>
<span id="cb155-2"><a href="transforma.html#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, dep_delay) <span class="sc">%&gt;%</span> </span>
<span id="cb155-3"><a href="transforma.html#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(dep_delay)) <span class="sc">%&gt;%</span> </span>
<span id="cb155-4"><a href="transforma.html#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(month, day, carrier, flight, dep_delay) <span class="sc">%&gt;%</span> </span>
<span id="cb155-5"><a href="transforma.html#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 10 x 5
##    month   day carrier flight dep_delay
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;int&gt;     &lt;dbl&gt;
##  1     1     9 HA          51      1301
##  2     6    15 MQ        3535      1137
##  3     1    10 MQ        3695      1126
##  4     9    20 AA         177      1014
##  5     7    22 MQ        3075      1005
##  6     4    10 DL        2391       960
##  7     3    17 DL        2119       911
##  8     6    27 DL        2007       899
##  9     7    22 DL        2047       898
## 10    12     5 AA         172       896</code></pre>
</div>
</div>
<div id="resumir-variables" class="section level3" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Resumir variables</h3>
<p>Con <code>summarise()</code> logramos “resumir” la información de determinadas variables, de acuerdo a cierta función que fijemos (media, mediana, IQR, etc.). Debes tener en cuenta que esto “colapsa” el data frame incial.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="transforma.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(flights, <span class="at">delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   delay
##   &lt;dbl&gt;
## 1  12.6</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="transforma.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(flights, <span class="at">delay =</span> <span class="fu">mean</span>(dep_delay))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   delay
##   &lt;dbl&gt;
## 1    NA</code></pre>
<p>Ahora, lo verdaderamente interesante de esta función es usarla para “observaciones agrupadas” con <code>group_by()</code>. Por ejemplo, queremos saber la media de los retrasos por mes y año:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="transforma.html#cb161-1" aria-hidden="true" tabindex="-1"></a>mean_m_y <span class="ot">&lt;-</span>  flights <span class="sc">%&gt;%</span> </span>
<span id="cb161-2"><a href="transforma.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month) <span class="sc">%&gt;%</span> </span>
<span id="cb161-3"><a href="transforma.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="transforma.html#cb163-1" aria-hidden="true" tabindex="-1"></a>mean_m_y</span></code></pre></div>
<pre><code>## # A tibble: 12 x 3
## # Groups:   year [1]
##     year month delay
##    &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
##  1  2013     1 10.0 
##  2  2013     2 10.8 
##  3  2013     3 13.2 
##  4  2013     4 13.9 
##  5  2013     5 13.0 
##  6  2013     6 20.8 
##  7  2013     7 21.7 
##  8  2013     8 12.6 
##  9  2013     9  6.72
## 10  2013    10  6.24
## 11  2013    11  5.44
## 12  2013    12 16.6</code></pre>
<p>Cambiando la variable de agrupamiento (debe ser categórica) podemos obtener la media (o cualqiuer otro estadístico que deseemos) para cada categoría. Veamos un ejemplo en combinación con <code>ggplot</code>:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="transforma.html#cb165-1" aria-hidden="true" tabindex="-1"></a>delays <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb165-2"><a href="transforma.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">%&gt;%</span> </span>
<span id="cb165-3"><a href="transforma.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb165-4"><a href="transforma.html#cb165-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb165-5"><a href="transforma.html#cb165-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist =</span> <span class="fu">mean</span>(distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb165-6"><a href="transforma.html#cb165-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb165-7"><a href="transforma.html#cb165-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb165-8"><a href="transforma.html#cb165-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="dv">20</span>, dest <span class="sc">!=</span> <span class="st">&quot;HNL&quot;</span>)</span>
<span id="cb165-9"><a href="transforma.html#cb165-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-10"><a href="transforma.html#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> delays, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y =</span> delay)) <span class="sc">+</span></span>
<span id="cb165-11"><a href="transforma.html#cb165-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> count), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb165-12"><a href="transforma.html#cb165-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
<p>Estamos agrupando por destino (<code>dest</code>) y luego contamos la cantidad de vuelos que van a cada destino (<code>count</code>), la distancia media (<code>dist</code>) entre los aeropuertos de origen y el destino, y el retraso medio en minutos de la llegada (<code>delay</code>). Habrás notado que filtramos los destinos con pocas visitas (pueden ser outliers) y Honolulu (está muy lejos de casi cualquier aeropuerto), para eliminar un poco de “ruido” en nuestro plot (intenta omitir el filtrado y notarás que es más difícil la interpretación). De este gráfico entendemos que mientras más cercano el destino, mayor probabilidad de retraso. Sin embargo, los vuelos a destinos lejanos parecen presentar menos retrasos (tal vez en el aire puedan compensar el retraso).</p>
<p>Otros ejemplos usando varias variables de agrupamiento:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="transforma.html#cb167-1" aria-hidden="true" tabindex="-1"></a>daily <span class="ot">&lt;-</span> <span class="fu">group_by</span>(flights, year, month, day)</span>
<span id="cb167-2"><a href="transforma.html#cb167-2" aria-hidden="true" tabindex="-1"></a>(per_day   <span class="ot">&lt;-</span> <span class="fu">summarise</span>(daily, <span class="at">flights =</span> <span class="fu">n</span>()))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;, &#39;month&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 365 x 4
## # Groups:   year, month [12]
##     year month   day flights
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;
##  1  2013     1     1     842
##  2  2013     1     2     943
##  3  2013     1     3     914
##  4  2013     1     4     915
##  5  2013     1     5     720
##  6  2013     1     6     832
##  7  2013     1     7     933
##  8  2013     1     8     899
##  9  2013     1     9     902
## 10  2013     1    10     932
## # ... with 355 more rows</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="transforma.html#cb170-1" aria-hidden="true" tabindex="-1"></a>(per_month <span class="ot">&lt;-</span> <span class="fu">summarise</span>(per_day, <span class="at">flights =</span> <span class="fu">sum</span>(flights)))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 12 x 3
## # Groups:   year [1]
##     year month flights
##    &lt;int&gt; &lt;int&gt;   &lt;int&gt;
##  1  2013     1   27004
##  2  2013     2   24951
##  3  2013     3   28834
##  4  2013     4   28330
##  5  2013     5   28796
##  6  2013     6   28243
##  7  2013     7   29425
##  8  2013     8   29327
##  9  2013     9   27574
## 10  2013    10   28889
## 11  2013    11   27268
## 12  2013    12   28135</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="transforma.html#cb173-1" aria-hidden="true" tabindex="-1"></a>(per_year  <span class="ot">&lt;-</span> <span class="fu">summarise</span>(per_month, <span class="at">flights =</span> <span class="fu">sum</span>(flights)))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##    year flights
## * &lt;int&gt;   &lt;int&gt;
## 1  2013  336776</code></pre>
<p>También, si deseas deshacer la agrupación, por ejemplo, si quieres contar el total de vuelos sin agrupar:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="transforma.html#cb175-1" aria-hidden="true" tabindex="-1"></a>daily <span class="sc">%&gt;%</span> </span>
<span id="cb175-2"><a href="transforma.html#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>             <span class="co"># deshacemoos la agrupación por fecha</span></span>
<span id="cb175-3"><a href="transforma.html#cb175-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">flights =</span> <span class="fu">n</span>())  <span class="co"># tooooooodos los vuelos :)</span></span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   flights
##     &lt;int&gt;
## 1  336776</code></pre>
<div id="ejercicios-12" class="section level4" number="3.2.5.1">
<h4><span class="header-section-number">3.2.5.1</span> Ejercicios</h4>
<ol start="19" style="list-style-type: decimal">
<li>Mira el número de vuelos cancelados por día e intenta encontrar algún patrón. ¿Está relacionada la proporción de vuelos cancelados con el retraso medio? Hint:</li>
</ol>
<ul>
<li>Crear una nueva variable/columna que indique si un vuelo se ha cancelado o no (definiremos <code>cancelado = (is.na(arr_delay) | is.na(dep_delay))</code>),</li>
<li>No olvides agrupar (año, mes, día ) y luego cuenta el número total de vuelos y el número de cancelados,</li>
<li>Haz un plot de cancelados vs. número de vuelos e intena describir posibles patrones,</li>
<li>Para responder la pregunta tendrás que crear una variable <code>prop_cancelados</code> (media) y la media de <code>dep_delay</code> o <code>arr_delay</code>,</li>
<li>Realiza los diagramas de dispersión correspondientes e intenta describir posibles patrones.</li>
</ul>
<p><strong>R/</strong></p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="transforma.html#cb177-1" aria-hidden="true" tabindex="-1"></a>cancelled_per_day <span class="ot">&lt;-</span> </span>
<span id="cb177-2"><a href="transforma.html#cb177-2" aria-hidden="true" tabindex="-1"></a>  flights <span class="sc">%&gt;%</span></span>
<span id="cb177-3"><a href="transforma.html#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cancelled =</span> (<span class="fu">is.na</span>(arr_delay) <span class="sc">|</span> <span class="fu">is.na</span>(dep_delay))) <span class="sc">%&gt;%</span></span>
<span id="cb177-4"><a href="transforma.html#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span></span>
<span id="cb177-5"><a href="transforma.html#cb177-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb177-6"><a href="transforma.html#cb177-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cancelled_num =</span> <span class="fu">sum</span>(cancelled),</span>
<span id="cb177-7"><a href="transforma.html#cb177-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">flights_num =</span> <span class="fu">n</span>(),</span>
<span id="cb177-8"><a href="transforma.html#cb177-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;, &#39;month&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="transforma.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cancelled_per_day) <span class="sc">+</span></span>
<span id="cb179-2"><a href="transforma.html#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> flights_num, <span class="at">y =</span> cancelled_num)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="transforma.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Respuesta a la pregunta:</span></span>
<span id="cb180-2"><a href="transforma.html#cb180-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-3"><a href="transforma.html#cb180-3" aria-hidden="true" tabindex="-1"></a>cancelled_and_delays <span class="ot">&lt;-</span> </span>
<span id="cb180-4"><a href="transforma.html#cb180-4" aria-hidden="true" tabindex="-1"></a>  flights <span class="sc">%&gt;%</span></span>
<span id="cb180-5"><a href="transforma.html#cb180-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cancelled =</span> (<span class="fu">is.na</span>(arr_delay) <span class="sc">|</span> <span class="fu">is.na</span>(dep_delay))) <span class="sc">%&gt;%</span></span>
<span id="cb180-6"><a href="transforma.html#cb180-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span></span>
<span id="cb180-7"><a href="transforma.html#cb180-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb180-8"><a href="transforma.html#cb180-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cancelled_prop =</span> <span class="fu">mean</span>(cancelled),</span>
<span id="cb180-9"><a href="transforma.html#cb180-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_dep_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb180-10"><a href="transforma.html#cb180-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_arr_delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb180-11"><a href="transforma.html#cb180-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb180-12"><a href="transforma.html#cb180-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;, &#39;month&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="transforma.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cancelled_and_delays) <span class="sc">+</span></span>
<span id="cb182-2"><a href="transforma.html#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> avg_dep_delay, <span class="at">y =</span> cancelled_prop))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-91-2.png" width="672" /></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="transforma.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cancelled_and_delays) <span class="sc">+</span></span>
<span id="cb183-2"><a href="transforma.html#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> avg_arr_delay, <span class="at">y =</span> cancelled_prop))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-91-3.png" width="672" /></p>
<ol start="20" style="list-style-type: decimal">
<li>¿A qué hora del día (<code>hour</code>) deberías viajar si quieres evitar retrasos tanto como sea posible? Hints:</li>
</ol>
<ul>
<li>Agrupar por la variable que consideres oportuna,</li>
<li>Resume el tiempo que ha demorado el vuelo (¿es más importante <code>arr_delay</code> o <code>dep_delay</code>?),</li>
<li>Reordena adecuadamente.</li>
</ul>
<p><strong>R/</strong></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="transforma.html#cb184-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="transforma.html#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hour) <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="transforma.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">arr_delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb184-4"><a href="transforma.html#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(arr_delay)</span></code></pre></div>
<pre><code>## # A tibble: 20 x 2
##     hour arr_delay
##    &lt;dbl&gt;     &lt;dbl&gt;
##  1     7    -5.30 
##  2     5    -4.80 
##  3     6    -3.38 
##  4     9    -1.45 
##  5     8    -1.11 
##  6    10     0.954
##  7    11     1.48 
##  8    12     3.49 
##  9    13     6.54 
## 10    14     9.20 
## 11    23    11.8  
## 12    15    12.3  
## 13    16    12.6  
## 14    18    14.8  
## 15    22    16.0  
## 16    17    16.0  
## 17    19    16.7  
## 18    20    16.7  
## 19    21    18.4  
## 20     1   NaN</code></pre>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="visualiza.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tidy.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
